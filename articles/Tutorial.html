<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="dsdp">
<title>A Tutorial for `dsdp` • dsdp</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="A Tutorial for `dsdp`">
<meta property="og:description" content="dsdp">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">dsdp</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/ProblemFormulations.html">Problem Formulations for `dsdp`</a>
    <a class="dropdown-item" href="../articles/Tutorial.html">A Tutorial for `dsdp`</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/tsuchiya-lab/dsdp/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>A Tutorial for `dsdp`</h1>
                        <h4 data-toc-skip class="author">Satoshi
Kakihara<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;National Graduate Institute for Policy Studies, &lt;a href="mailto:skakihara@gmail.com" class="email"&gt;skakihara@gmail.com&lt;/a&gt;&lt;/p&gt;'><sup>1</sup></a>
</h4>
                        <h4 data-toc-skip class="author">Takashi
Tsuchiya<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;National Graduate Institute for Policy Studies, &lt;a href="mailto:tsuchiya@grips.ac.jp" class="email"&gt;tsuchiya@grips.ac.jp&lt;/a&gt;&lt;/p&gt;'><sup>2</sup></a>
</h4>
            
            <h4 data-toc-skip class="date">October 31st, 2022</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/tsuchiya-lab/dsdp/blob/HEAD/vignettes/Tutorial.Rmd" class="external-link"><code>vignettes/Tutorial.Rmd</code></a></small>
      <div class="d-none name"><code>Tutorial.Rmd</code></div>
    </div>

    
        <div class="abstract">
      <p class="abstract">Abstract</p>
      <p>This vignette is a tutorial for a R package <code>dsdp</code>,
      a probability density estimation package using a maximum
      likelihood method. A model of interest in this package is a family
      of exponential distributions as base functions, with polynomial
      correction terms. To find an optimal model, we adopt a grid search
      for parameters of base functions and degrees of polynomials,
      together with semidefinite programming for coefficients of
      polynomials, and then model selection is done by Akaike
      Information Criterion. We first give a quick overview of the
      package, and then move on to a tutorial.</p>
    </div>
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>The main task of the package <code>dsdp</code> is to estimate
probability density functions from a data set using a maximum likelihood
method. The models of density functions in use are familiar Gaussian or
exponential distributions with polynomial correction terms. We call
Gaussian distribution with a polynomial <strong>Gaussian-based
model</strong> and an exponential distribution with a polynomial
<strong>Exponential-based model</strong>, respectively.
<code>dsdp</code> seeks parameters of Gaussian or exponential
distributions together with degrees of polynomials using a grid search,
and coefficients of polynomials using a variant of semidefinite
programming(SDP) problems. Detailed discussions of SDP problem
formulations and this type of SDP problems are found in other
vignettes.</p>
<p>The outline of estimation procedure is as follows.</p>
<ol style="list-style-type: decimal">
<li>Create Gaussian-based or Exponential-based model from a data
set.</li>
<li>Explore a data set by checking the statistics and the histogram</li>
<li>Provide a set of parameters of Gaussian or exponential distributions
and degrees of polynomials.</li>
<li>Estimate the coefficients of the polynomials for a set of parameters
and then check the results by comparing Akaike Information
Criterion(AIC) and plotting density functions.</li>
<li>Refine the parameters and repeat 3-4 until a sufficient estimate is
obtained.</li>
</ol>
<p>We will see each process step by step in the next section. Before we
move on, please install and import the package if you haven’t yet.
Installation is done by</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Install from CRAN</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"dsdp"</span><span class="op">)</span></span></code></pre></div>
<p>Importing the package is done by</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Import dsdp</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tsuchiya-lab.github.io/dsdp/">dsdp</a></span><span class="op">)</span></span></code></pre></div>
<p>This package requires <code>ggplot2</code> for displaying histograms
and density functions. <code>ggplot2</code> is a part of <a href="https://www.tidyverse.org" class="external-link"><code>tidyverse</code></a> <span class="citation">(<a href="#ref-tidyverse2019" role="doc-biblioref">Wickham et al. 2019</a>)</span>, a de facto
standard for data wrangling in R. Our <code>plot</code> method returns
<code>ggplot2</code> objects, so if you plan to add the title or change
the labels in the graphs, it is better to import <code>ggplot2</code>
too.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Import ggplot2 if necessary.</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="a-tutorial">A Tutorial<a class="anchor" aria-label="anchor" href="#a-tutorial"></a>
</h2>
<p>In this section, we will see estimation procedures in Gaussian-based
model and Exponential-based model in details. Essentially, they are same
in computations, yet there are subtle differences in practice.</p>
<div class="section level3">
<h3 id="gaussian-based-model">Gaussian-based Model<a class="anchor" aria-label="anchor" href="#gaussian-based-model"></a>
</h3>
<p>The density function of Gaussian-based model is <span class="math display">\[
p(x; \boldsymbol{\alpha}) \cdot N(x; \mu, \sigma^2),
\]</span> where <span class="math inline">\(p(x;
\boldsymbol{\alpha})\)</span> is a polynomial with a coefficient vector
<span class="math inline">\(\boldsymbol{\alpha}\)</span>, and <span class="math inline">\(N(x; \mu, \sigma^2)\)</span> is Gaussian
distribution with mean <span class="math inline">\(\mu\)</span> and
variance <span class="math inline">\(\sigma^2\)</span>: <span class="math display">\[
N(x;\mu, \sigma^2) := \frac{1}{\sigma \sqrt{2\pi}}
\exp\left(-\frac{(x-\mu)^2}{2\sigma^2}\right).
\]</span></p>
<p>The aim of estimation is to find a good set of parameters: <span class="math inline">\(\boldsymbol{\alpha}\)</span>, <span class="math inline">\(\mu\)</span>, and <span class="math inline">\(\sigma\)</span>. To this end, we first provide a
coarse set of parameters of base functions, namely, <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span>, along with degrees of
polynomials, and then compute the coefficients of polynomials <span class="math inline">\(\boldsymbol{\alpha}\)</span>, to get a rough idea
of the model. And subsequently, refine the set of parameters and repeat
above process until sufficient estimate is obtained.</p>
<div class="section level4">
<h4 id="a-creation-of-a-model">A Creation of a model<a class="anchor" aria-label="anchor" href="#a-creation-of-a-model"></a>
</h4>
<p>We first create Gaussian-based model from a data set. The name of R’s
S3 class for Gaussian-based model is <code>gaussmodel</code>, and we
refer to the method of <code>gaussmodel</code> as
<em>method.gaussmodel</em>, for example,
<code>summmary.gaussmodel</code>, <code>plot.gaussmodel</code>,
<code>estimate.gaussmodel</code>, <code>func.gaussmodel</code>.</p>
<p>There are two scenarios for model creations. One is to create a model
from only a data set, and the other is to create a model from a data set
and its corresponding frequency data. Let’s see model creations in
examples.</p>
<p>In the first case, we use a data set <code>mix2gauss$n200</code>,
which contains 200 realizations of bimodal mixed Gaussian distributions,
to create R’s S3 class <code>gaussmodel</code> object
<code>gm1</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Create gaussmodel object from a data set mix2gauss$n200</span></span>
<span><span class="va">gm1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gaussmodel.html">gaussmodel</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">mix2gauss</span><span class="op">$</span><span class="va">n200</span><span class="op">)</span></span></code></pre></div>
<p>The object <code>gm1</code>, an instance of a S3 class
<code>gaussmodel</code>, contains the data and parameters to be
estimated.</p>
<p>Similarly, in the second case, we use
<code>mix2gaussHist$n200p</code> for data points and
<code>mix2gaussHist$n200f</code> for their corresponding frequencies, to
create <code>gaussmodel</code> object <code>gm2</code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Create gaussmodel object from a data set mix2gaussHist$n200p and </span></span>
<span><span class="co">## its frequencies mix2gaussHist$n200f</span></span>
<span><span class="va">gm2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gaussmodel.html">gaussmodel</a></span><span class="op">(</span><span class="va">mix2gaussHist</span><span class="op">$</span><span class="va">n200p</span>, <span class="va">mix2gaussHist</span><span class="op">$</span><span class="va">n200f</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="exploring-a-data-set">Exploring a data set<a class="anchor" aria-label="anchor" href="#exploring-a-data-set"></a>
</h4>
<p>A summary of <code>gm1</code> is displayed:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Display the summary of a data set</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">gm1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   SUMMARY</span></span>
<span><span class="co">## Name: mix2gauss$n200 </span></span>
<span><span class="co">## The number of Data:  200 </span></span>
<span><span class="co">## Mean   Std.</span></span>
<span><span class="co">## 0.4503117 1.022398 </span></span>
<span><span class="co">## Quantile:</span></span>
<span><span class="co">##         0%        25%        50%        75%       100% </span></span>
<span><span class="co">## -2.1092675 -0.2774186  0.7110494  1.2108179  2.0967254 </span></span>
<span><span class="co">## Quantile of Scaled Data:</span></span>
<span><span class="co">##         0%        25%        50%        75%       100% </span></span>
<span><span class="co">## -2.5035068 -0.7117881  0.2550257  0.7438459  1.6103458</span></span></code></pre>
<p>As a name suggests, <code>summary.gaussmodel</code> shows the basic
statistics of a data set. It prints out the quantiles of standardized
data as well as original data. Here standardization means rescaling of
data so as to have a mean 0 and a standard deviation 1.</p>
<p>The histogram of the data is displayed:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Draw a histogram of the data set</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">gm1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: The dot-dot notation (`..density..`) was deprecated in ggplot2 3.4.0.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Please use `after_stat(density)` instead.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> The deprecated feature was likely used in the <span style="color: #0000BB;">dsdp</span> package.</span></span>
<span><span class="co">##   Please report the issue at <span style="color: #0000BB; font-style: italic;">&lt;https://github.com/tsuchiya-lab/dsdp/issues&gt;</span>.</span></span></code></pre>
<p><img src="Tutorial_files/figure-html/unnamed-chunk-7-1.png" width="70%" height="80%"></p>
<p><code>plot.gaussmodel</code> can plot scaled data as well as original
data by setting <code>scaling=TRUE</code>.</p>
<!-- The default number of bins is 40, which can be changed, for example,

````r
## Output is omitted for brevity
plot(gm1, bins=50)
``` -->
</div>
<div class="section level4">
<h4 id="providing-the-set-of-parameters">Providing the set of parameters<a class="anchor" aria-label="anchor" href="#providing-the-set-of-parameters"></a>
</h4>
<p>Before estimation, we need to provide a set of parameters, means,
standard deviations, and degrees of polynomials, to compute the
coefficients of polynomials. ````</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## A vector of degrees of polynomials</span></span>
<span><span class="va">deglist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">6</span><span class="op">)</span></span>
<span><span class="co">## A vector of means in Gaussian distributions</span></span>
<span><span class="va">mulist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span>, <span class="fl">0</span>, <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="co">## A vector of standard deviations in Gaussian distributions</span></span>
<span><span class="va">sdlist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.75</span>, <span class="fl">1.0</span>, <span class="fl">1.25</span><span class="op">)</span></span></code></pre></div>
<p>A vector <code>deglist</code> indicates degrees of polynomials, in
this case <code>2, 4, 6</code>. In Gaussian-based model, a positive even
integer up to around 20 is okay. Note that large degrees can cause
numerical difficulty. <code>mulist</code> is a vector of means of
Gaussian distribution, and <code>sdlist</code> is a vector of standard
deviations of Gaussian distribution, so the element of
<code>sdlist</code> should be positive.</p>
<p>Note that we set these data for estimation of scaled data, as we will
mention later.</p>
<!-- **Note that the mean and the standard deviation to be passed to 
an `estimate.gaussmodel` method are applied to
internally standardized data, not original data.** -->
</div>
<div class="section level4">
<h4 id="estimation">Estimation<a class="anchor" aria-label="anchor" href="#estimation"></a>
</h4>
<p>Providing these parameter sets, we are now ready to estimate the
model.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Do estimation</span></span>
<span><span class="co">## Output messages are suppressed for brevity</span></span>
<span><span class="va">gm1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate.html">estimate</a></span><span class="op">(</span><span class="va">gm1</span>, deglist<span class="op">=</span><span class="va">deglist</span>, mulist<span class="op">=</span><span class="va">mulist</span>, sdlist<span class="op">=</span><span class="va">sdlist</span>, scaling<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>The computation of the coefficients of the polynomials is done for
all of the combinations of the parameter sets <code>deglist</code>,
<code>mulist</code>, and <code>sdlist</code>, 9 cases in this example.
By setting <code>scaling=TRUE</code>, estimation is done for scaled
data, not for original data, as mentioned before. The result is sorted
according to Akaike information criterion(AIC) <span class="citation">(<a href="#ref-akaike1974new" role="doc-biblioref">Akaike 1974</a>)</span>. AIC is widely used
criterion for model selection so as to avoid overfitting by penalizing
the number of free parameters.</p>
<p>Let’s see the result of estimation.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Show the summary of results up to 5</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">gm1</span>, nmax<span class="op">=</span><span class="fl">5</span>, estonly<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   ESTIMATION</span></span>
<span><span class="co">## Name: mix2gauss$n200 </span></span>
<span><span class="co">##   deg         mu1      sig1   mu  sig      aic     accuracy</span></span>
<span><span class="co">## 1   6  0.96151051 0.7667982  0.5 0.75 149.9553 7.159002e-08</span></span>
<span><span class="co">## 2   6  0.45031175 0.7667982  0.0 0.75 150.2469 7.345730e-08</span></span>
<span><span class="co">## 3   4  0.45031175 0.7667982  0.0 0.75 150.9287 5.479310e-08</span></span>
<span><span class="co">## 4   6 -0.06088702 0.7667982 -0.5 0.75 152.5820 7.559624e-08</span></span>
<span><span class="co">## 5   4 -0.06088702 0.7667982 -0.5 0.75 157.0336 5.499543e-08</span></span></code></pre>
<p>(<code>nmax=5</code> limits top 5 estimates, and
<code>estonly=TRUE</code> suppresses the basic statistics.)</p>
<p>The columns of <code>deg</code>, <code>mu1</code> and
<code>sig1</code> indicate the degree of polynomials, mean, and standard
deviation, respectively. And the column of <code>mu</code> and
<code>sig</code> indicate the scaled mean and standard deviation,
respectively.</p>
<p>The column of <code>aic</code> indicates AIC and that of
<code>accuracy</code> does the accuracy of underlying SDP solver, whose
value around <span class="math inline">\(1.0^{-7}\)</span> is sufficient
for estimation under IEEE 754<br>
double precision. If sufficient accuracy is not achieved because of
numerical difficulty, set <code>recompute=TRUE</code> and
<code>stepsize=c(0.4, 0.2)</code>, for example, and try
recomputation.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## This is demonstration for recomputation</span></span>
<span><span class="co">## Not Executed</span></span>
<span><span class="va">gm1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate.html">estimate</a></span><span class="op">(</span><span class="va">gm1</span>, deglist<span class="op">=</span><span class="va">deglist</span>, mulist<span class="op">=</span><span class="va">mulist</span>, sdlist<span class="op">=</span><span class="va">sdlist</span>, scaling<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>          recompute<span class="op">=</span><span class="cn">TRUE</span>, stepsize<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.4</span>, <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The flag <code>stepsize</code> indicates the vector of step sizes of
the underlying SDP solver. The smaller the values are, the better the
chances of successful estimation, but the slower the computation is. The
default value of <code>stepsize</code> is <code>c(0.5, 0.3)</code>,
which is enough in many cases. We will not discuss the implementation
details here, but if the user sets <code>stepsize</code> by oneself, the
user should set the values smaller than default values and the length of
two is enough.</p>
<p>The numbers 1,2,3,… in the leftmost column indicate the indices of
estimates ordered by AIC. First row is the best estimate, second row is
the second best, so on, and these numbers can be used in
<code>plot.gaussmodel</code> or <code>func.gaussmodel</code> to
designate the estimates to be plotted or evaluated, respectively.</p>
<p>To see the graphs of estimated densities along with the histogram,
simply type:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">gm1</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutorial_files/figure-html/unnamed-chunk-13-1.png" width="70%" height="80%"></p>
<p>By default, <code>plot.gaussmodel</code> plots up to best 4 estimated
density functions. In the legend, the color of graphs are displayed in
increasing order of AIC. For example, in this graph, the estimation with
the degree 6, mean 0.96151, standard deviation 0.76680 is the best
one.</p>
<p>By setting <code>scaling=TRUE</code>, it can plot a scaled data, like
scaled graphs.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">gm1</span>, scaling<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutorial_files/figure-html/unnamed-chunk-14-1.png" width="70%" height="80%"></p>
<p>Similarly, in the legend, the color of graphs are displayed in
increasing order of AIC. For example, in this graph, the estimation with
the degree 6, mean 0.5, standard deviation 0.75 is the best one.</p>
</div>
<div class="section level4">
<h4 id="refine-estimation">Refine estimation<a class="anchor" aria-label="anchor" href="#refine-estimation"></a>
</h4>
<p>We continue to estimate further by adding the degree 8 and refining
<code>mulist=seq(0, 0.5, by=0.1)</code> and
<code>sdlist=seq(0.6, 0.9, by=0.1)</code>. Here <code>seq</code> command
generates the vector starting from 0, incrementing by 0.1, and ending
with 0.5, in case of <code>seq(0, 0.5, by=0.1)</code>.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Do estimation</span></span>
<span><span class="co">## Output messages are suppressed for brevity</span></span>
<span><span class="va">gm1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate.html">estimate</a></span><span class="op">(</span><span class="va">gm1</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">6</span>, <span class="fl">8</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.5</span>, by<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1</span>, by<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span>,</span>
<span>        scaling<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>Note that parameters already estimated are skipped in
<code>estimate.gaussmodel</code> and we omit argument names.</p>
<p>The summary of estimation is displayed:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Show the summary of results up to 5</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">gm1</span>, nmax<span class="op">=</span><span class="fl">5</span>, estonly<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   ESTIMATION</span></span>
<span><span class="co">## Name: mix2gauss$n200 </span></span>
<span><span class="co">##   deg       mu1      sig1  mu sig      aic     accuracy</span></span>
<span><span class="co">## 1   8 0.4503117 0.5111988 0.0 0.5 148.0353 7.603908e-08</span></span>
<span><span class="co">## 2   4 0.5525515 0.7156783 0.1 0.7 148.3883 5.332699e-08</span></span>
<span><span class="co">## 3   4 0.4503117 0.7156783 0.0 0.7 148.9077 5.384915e-08</span></span>
<span><span class="co">## 4   4 0.6547913 0.7156783 0.2 0.7 149.4495 5.285857e-08</span></span>
<span><span class="co">## 5   8 0.4503117 0.6134385 0.0 0.6 149.5980 6.341800e-08</span></span></code></pre>
<p>The graphs are displayed:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">gm1</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutorial_files/figure-html/unnamed-chunk-17-1.png" width="70%" height="80%"></p>
<p>We continue to do estimation by refining parameters and checking
estimates and graphs.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Do estimation</span></span>
<span><span class="co">## Output messages are suppressed for brevity</span></span>
<span><span class="va">gm1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate.html">estimate</a></span><span class="op">(</span><span class="va">gm1</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">6</span>, <span class="fl">8</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.2</span>, by<span class="op">=</span><span class="fl">0.05</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.6</span>, <span class="fl">0.8</span>, by<span class="op">=</span><span class="fl">0.05</span><span class="op">)</span>,</span>
<span>          scaling<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Show the summary of results up to 5</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">gm1</span>, nmax<span class="op">=</span><span class="fl">5</span>, estonly<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   ESTIMATION</span></span>
<span><span class="co">## Name: mix2gauss$n200 </span></span>
<span><span class="co">##   deg       mu1      sig1   mu  sig      aic     accuracy</span></span>
<span><span class="co">## 1   8 0.4503117 0.5111988 0.00 0.50 148.0353 7.603908e-08</span></span>
<span><span class="co">## 2   4 0.5525515 0.7156783 0.10 0.70 148.3883 5.332699e-08</span></span>
<span><span class="co">## 3   4 0.6547913 0.7667982 0.20 0.75 148.4273 5.429469e-08</span></span>
<span><span class="co">## 4   4 0.5014316 0.7156783 0.05 0.70 148.5121 5.360879e-08</span></span>
<span><span class="co">## 5   4 0.6036714 0.7667982 0.15 0.75 148.5294 5.448186e-08</span></span></code></pre>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">gm1</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutorial_files/figure-html/unnamed-chunk-20-1.png" width="70%" height="80%"></p>
<p>According to above results, we confine the degrees of polynomials
only to 4, and set <code>mulist=seq(0, 0.2, by=0.025)</code> and
<code>sdlist=seq(0.7, 0.8, by=0.01)</code>.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Do estimation</span></span>
<span><span class="co">## Output messages are suppressed for brevity</span></span>
<span><span class="va">gm1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate.html">estimate</a></span><span class="op">(</span><span class="va">gm1</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">6</span>, <span class="fl">8</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.2</span>, by<span class="op">=</span><span class="fl">0.025</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.7</span>, <span class="fl">0.8</span>, by<span class="op">=</span><span class="fl">0.01</span><span class="op">)</span>,</span>
<span>          scaling<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Show the summary of results up to 5</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">gm1</span>, nmax<span class="op">=</span><span class="fl">5</span>, estonly<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   ESTIMATION</span></span>
<span><span class="co">## Name: mix2gauss$n200 </span></span>
<span><span class="co">##   deg       mu1      sig1    mu  sig      aic     accuracy</span></span>
<span><span class="co">## 1   8 0.4503117 0.5111988 0.000 0.50 148.0353 7.603908e-08</span></span>
<span><span class="co">## 2   4 0.6036714 0.7463502 0.150 0.73 148.1563 5.402242e-08</span></span>
<span><span class="co">## 3   4 0.5781114 0.7361262 0.125 0.72 148.1631 5.390074e-08</span></span>
<span><span class="co">## 4   4 0.6036714 0.7361262 0.150 0.72 148.1694 5.373495e-08</span></span>
<span><span class="co">## 5   4 0.6292313 0.7463502 0.175 0.73 148.1959 5.394311e-08</span></span></code></pre>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">gm1</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutorial_files/figure-html/unnamed-chunk-23-1.png" width="70%" height="80%"></p>
<p>We stop doing estimation here.
<!-- In our heuristics, if we can confine up to 0.01 in `sdlist`, we can achieve
reasonable estimates. --></p>
</div>
<div class="section level4">
<h4 id="some-notes">Some Notes<a class="anchor" aria-label="anchor" href="#some-notes"></a>
</h4>
<p>Using <code>plot.gaussmodel</code>, we can plot cumulative
distribution functions by <code>cum=TRUE</code>:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">gm1</span>, cum<span class="op">=</span><span class="cn">TRUE</span>, nmax<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutorial_files/figure-html/unnamed-chunk-24-1.png" width="70%" height="80%"></p>
<p>For more details, see <code><a href="../reference/plot.gaussmodel.html">?plot.gaussmodel</a></code>.</p>
<p><code>func.gaussmodel</code> computes the values of density and
cumulative distribution of desired estimate. For example,</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4</span>, <span class="fl">4</span>, by<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="co">## Compute the density of 1st estimate</span></span>
<span><span class="va">y_pdf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/func.html">func</a></span><span class="op">(</span><span class="va">gm1</span>, <span class="va">x</span>, n<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">## Compute the cumulative distribution of 1st estimate</span></span>
<span><span class="va">y_cdf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/func.html">func</a></span><span class="op">(</span><span class="va">gm1</span>, <span class="va">x</span>, cdf<span class="op">=</span><span class="cn">TRUE</span>, n<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p>Of course, we can compute the desired estimate by designating
<code>n=k</code> for kth estimate shown in
<code>summary.gaussmodel</code>.</p>
</div>
</div>
<div class="section level3">
<h3 id="exponential-based-model">Exponential-based Model<a class="anchor" aria-label="anchor" href="#exponential-based-model"></a>
</h3>
<p>The density function of Exponential-based model is <span class="math display">\[
p(x; \boldsymbol{\alpha}) \cdot \mathrm{Exp}(x; \lambda),
\]</span> where <span class="math inline">\(p(x;
\boldsymbol{\alpha})\)</span> is a polynomial with a coefficient vector
<span class="math inline">\(\boldsymbol{\alpha}\)</span>, and <span class="math inline">\(\mathrm{Exp}(x; \lambda)\)</span> is an
exponential distribution with rate parameter <span class="math inline">\(\lambda\)</span>: <span class="math display">\[
\mathrm{Exp}(x;\lambda) := \lambda e^{-\lambda x}, \quad x \in S = [0,
\infty).
\]</span></p>
<p>The aim of estimation is to find a good set of parameters: <span class="math inline">\(\boldsymbol{\alpha}\)</span>, <span class="math inline">\(\lambda\)</span>. To this end, we first provide a
coarse set of parameters of base functions, namely, <span class="math inline">\(\lambda\)</span>, and a degree of polynomials, and
then compute the coefficients of polynomials <span class="math inline">\(\boldsymbol{\alpha}\)</span>, to get a rough idea
of the model.</p>
<div class="section level4">
<h4 id="a-creation-of-a-model-1">A Creation of a model<a class="anchor" aria-label="anchor" href="#a-creation-of-a-model-1"></a>
</h4>
<p>The creation of Exponential-based model from a data set is same as
that of Gaussian-based model. We will show the two scenarios, one is to
create a model from only a data set, and the other is to create a model
from a data set and its corresponding frequency data, in sequel.</p>
<p>In the first case, we use a data set <code>mixexpgamma$n200</code>,
which contains 200 realizations of mixture of an exponential
distribution and a gamma distribution, to create R’s S3 class
<code>expmodel</code> object <code>em1</code>.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">em1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/expmodel.html">expmodel</a></span><span class="op">(</span><span class="va">mixexpgamma</span><span class="op">$</span><span class="va">n200</span><span class="op">)</span></span></code></pre></div>
<p>The object <code>em1</code> of a S3 class <code>expmodel</code>
contains the data and parameters to be estimated.</p>
<p>Similarly, in the second case, we use
<code>mixExpGammaHist$n800p</code> for data points and
<code>mixExpGammaHist$n800f</code> for their corresponding frequencies,
to create <code>expmodel</code> object <code>em2</code>.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">em2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/expmodel.html">expmodel</a></span><span class="op">(</span><span class="va">mixExpGammaHist</span><span class="op">$</span><span class="va">n800p</span>, <span class="va">mixExpGammaHist</span><span class="op">$</span><span class="va">n800f</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="exploring-of-a-data-set">Exploring of a data set<a class="anchor" aria-label="anchor" href="#exploring-of-a-data-set"></a>
</h4>
<p>A summary of <code>em1</code> is displayed:</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Display the summary of a data set</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">em1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   SUMMARY</span></span>
<span><span class="co">## Name: mixexpgamma$n200 </span></span>
<span><span class="co">## The number of Data:  200 </span></span>
<span><span class="co">## Mean   Std.</span></span>
<span><span class="co">## 3.297944 2.491842 </span></span>
<span><span class="co">## Quantile:</span></span>
<span><span class="co">##           0%          25%          50%          75%         100% </span></span>
<span><span class="co">##  0.007558929  1.395016398  3.076594706  4.588611178 11.529857185 </span></span>
<span><span class="co">## Quantile of Scaled Data:</span></span>
<span><span class="co">##          0%         25%         50%         75%        100% </span></span>
<span><span class="co">## 0.002292013 0.422995795 0.932882670 1.391355136 3.496074388</span></span></code></pre>
<p>As a name suggests, <code>summary.expmodel</code> shows the basic
statistics of a data set. It prints out the quantiles of scaled data as
well as original data. Here the scaling is to divide the data by the
mean of the data.</p>
<p>The histogram of the data is displayed:</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Draw a histogram of the data set</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">em1</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutorial_files/figure-html/unnamed-chunk-29-1.png" width="70%" height="80%"></p>
<p><code>plot.expmodel</code> can plot scaled data as well as original
data by setting <code>scaling=TRUE</code>.</p>
</div>
<div class="section level4">
<h4 id="providing-the-set-of-parameters-1">Providing the set of parameters<a class="anchor" aria-label="anchor" href="#providing-the-set-of-parameters-1"></a>
</h4>
<p>Before estimation, we need to provide a set of rate parameters, and
degrees of polynomials, to compute the coefficients of polynomials.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## A vector of degrees of polynomials</span></span>
<span><span class="va">deglist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="co">## A vector of rate parameters of exponential distributions</span></span>
<span><span class="va">lmdlist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">4</span><span class="op">)</span></span></code></pre></div>
<p><code>deglist</code> is a vector of degrees of polynomials, in this
case <code>2, 3, 4</code>. In Exponential-based model, a positive
integer up to around 20 is okay. Note that large degrees can cause
numerical difficulty. <code>lmdlist</code> is a vector of means of
exponential distributions, so the element of <code>lmdlist</code> should
be positive.</p>
<p>Also note that the rate parameters to be passed to an
<code>estimate.expmodel</code> method are applied to internally scaled
data, not original data.</p>
</div>
<div class="section level4">
<h4 id="estimation-1">Estimation<a class="anchor" aria-label="anchor" href="#estimation-1"></a>
</h4>
<p>Providing these parameter sets, we are now ready to estimate the
model.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Do estimation</span></span>
<span><span class="co">## Output messages are suppressed for brevity</span></span>
<span><span class="va">em1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate.html">estimate</a></span><span class="op">(</span><span class="va">em1</span>, deglist<span class="op">=</span><span class="va">deglist</span>, lmdlist<span class="op">=</span><span class="va">lmdlist</span><span class="op">)</span></span></code></pre></div>
<p>The computation of the coefficients of the polynomials is done for
all of the combinations of the parameter sets <code>deglist</code>,
<code>lmdlist</code>, 12 cases in this example. The result is sorted
according to Akaike information criterion(AIC)</p>
<p>Let’s see the result of estimation.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Show the summary of results up to 5</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">em1</span>, nmax<span class="op">=</span><span class="fl">5</span>, estonly<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   ESTIMATION</span></span>
<span><span class="co">## Name: mixexpgamma$n200 </span></span>
<span><span class="co">##   deg lmd      aic     accuracy</span></span>
<span><span class="co">## 1   4   2 185.4038 9.552443e-08</span></span>
<span><span class="co">## 2   4   4 185.4254 9.152939e-08</span></span>
<span><span class="co">## 3   3   4 191.2761 7.245070e-08</span></span>
<span><span class="co">## 4   2   2 192.7590 5.681183e-08</span></span>
<span><span class="co">## 5   3   2 193.7590 7.548828e-08</span></span></code></pre>
<p>(<code>nmax=5</code> limits top 5 estimates, and
<code>estonly=TRUE</code> suppresses the basic statistics.)</p>
<p>Next see the histogram.</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">em1</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutorial_files/figure-html/unnamed-chunk-33-1.png" width="70%" height="80%"></p>
</div>
<div class="section level4">
<h4 id="refine-estimation-1">Refine estimation<a class="anchor" aria-label="anchor" href="#refine-estimation-1"></a>
</h4>
<p>We continue to estimate further by adding parameters. As we see in
<code>estimate.gaussmodel</code>, paramters already estimated are
skipped.</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Do estimation</span></span>
<span><span class="co">## Output messages are suppressed for brevity</span></span>
<span><span class="va">em1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate.html">estimate</a></span><span class="op">(</span><span class="va">em1</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">6</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">8</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The summary of the estimation is:</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Show the summary of results up to 5</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">em1</span>, nmax<span class="op">=</span><span class="fl">5</span>, estonly<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   ESTIMATION</span></span>
<span><span class="co">## Name: mixexpgamma$n200 </span></span>
<span><span class="co">##   deg lmd      aic     accuracy</span></span>
<span><span class="co">## 1   5   4 183.0460 6.715532e-08</span></span>
<span><span class="co">## 2   6   4 183.9109 9.767674e-08</span></span>
<span><span class="co">## 3   6   2 184.7760 6.458883e-08</span></span>
<span><span class="co">## 4   4   2 185.4038 9.552443e-08</span></span>
<span><span class="co">## 5   4   4 185.4254 9.152939e-08</span></span></code></pre>
<p>The graphs are:</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">em1</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutorial_files/figure-html/unnamed-chunk-36-1.png" width="70%" height="80%"></p>
<!-- ```{r eval=TRUE, results="hide", message=FALSE}
## Do estimation
## Output messages are suppressed for brevity
em1 <- estimate(em1, c(5, 6, 7), c(2, 3, 4))
``` -->
<p>We further confine parameters as follows:</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Do estimation</span></span>
<span><span class="co">## Output messages are suppressed for brevity</span></span>
<span><span class="va">em1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate.html">estimate</a></span><span class="op">(</span><span class="va">em1</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">6</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">4</span>, by<span class="op">=</span><span class="fl">0.25</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>And see the summary of estimation:</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Show the summary of results up to 5</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">em1</span>, nmax<span class="op">=</span><span class="fl">5</span>, estonly<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   ESTIMATION</span></span>
<span><span class="co">## Name: mixexpgamma$n200 </span></span>
<span><span class="co">##   deg  lmd      aic     accuracy</span></span>
<span><span class="co">## 1   5 3.75 183.0320 6.051333e-08</span></span>
<span><span class="co">## 2   5 4.00 183.0460 6.715532e-08</span></span>
<span><span class="co">## 3   5 3.50 183.4025 6.287455e-08</span></span>
<span><span class="co">## 4   5 3.25 183.7779 5.609403e-08</span></span>
<span><span class="co">## 5   5 3.00 183.9076 5.846981e-08</span></span></code></pre>
<p>The graphs are as follows:</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">em1</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutorial_files/figure-html/unnamed-chunk-39-1.png" width="70%" height="80%"></p>
<p>Theoretically, we can refine estimation as you like, but we stop
estimation here.</p>
</div>
<div class="section level4">
<h4 id="some-notes-1">Some Notes<a class="anchor" aria-label="anchor" href="#some-notes-1"></a>
</h4>
<p>Using <code>plot.expmodel</code>, we can plot cumulative distribution
functions by <code>cum=TRUE</code>:</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">em1</span>, cum<span class="op">=</span><span class="cn">TRUE</span>, nmax<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutorial_files/figure-html/unnamed-chunk-40-1.png" width="70%" height="80%"></p>
<p>For more details, see <code><a href="../reference/plot.expmodel.html">?plot.expmodel</a></code>.</p>
<p><code>func.expmodel</code> computes the values of density and
cumulative distribution of desired estimate. For example,</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">14</span>, by<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="co">## Compute the density of 1st estimate</span></span>
<span><span class="va">y_pdf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/func.html">func</a></span><span class="op">(</span><span class="va">em1</span>, <span class="va">x</span>, n<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">## Compute the cumulative distribution of 1st estimate</span></span>
<span><span class="va">y_cdf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/func.html">func</a></span><span class="op">(</span><span class="va">em1</span>, <span class="va">x</span>, cdf<span class="op">=</span><span class="cn">TRUE</span>, n<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p>Of course, we can compute the desired estimate by designating
<code>n=k</code> for kth estimate shown in
<code>summary.expmodel</code>.</p>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-akaike1974new" class="csl-entry">
Akaike, Hirotugu. 1974. <span>“A New Look at the Statistical Model
Identification.”</span> <em>IEEE Transactions on Automatic Control</em>
19 (6): 716–23.
</div>
<div id="ref-tidyverse2019" class="csl-entry">
Wickham, Hadley, Mara Averick, Jennifer Bryan, Winston Chang, Lucy
D’Agostino McGowan, Romain François, Garrett Grolemund, et al. 2019.
<span>“Welcome to the <span class="nocase">tidyverse</span>.”</span>
<em>Journal of Open Source Software</em> 4 (43): 1686. <a href="https://doi.org/10.21105/joss.01686" class="external-link">https://doi.org/10.21105/joss.01686</a>.
</div>
</div>
</div>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Satoshi Kakihara, Takashi Tsuchiya.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
